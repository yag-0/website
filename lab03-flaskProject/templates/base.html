<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Etkaroz{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes slideDown {
            0% { max-height: 0; opacity: 0; }
            100% { max-height: 300px; opacity: 1; }
        }
        @keyframes slideUp {
            0% { max-height: 300px; opacity: 1; }
            100% { max-height: 0; opacity: 0; }
        }
        .animate-slide-down {
            animation: slideDown 0.3s ease-out forwards;
        }
        .animate-slide-up {
            animation: slideUp 0.3s ease-in forwards;
        }
        .burger-line {
            transition: all 0.3s ease-in-out;
        }
        .open .line1 {
            transform: rotate(-45deg) translate(-5px, 6px);
        }
        .open .line2 {
            opacity: 0;
        }
        .open .line3 {
            transform: rotate(45deg) translate(-5px, -6px);
        }
        
        /* Dark mode styles */
        html.dark {
            color-scheme: dark;
        }
        
        html.dark body {
            background-color: #111827;
            color: white;
        }
        
        html.dark .bg-white {
            background-color: #1f2937;
        }
        
        html.dark .bg-gray-100 {
            background-color: #111827;
        }
        
        html.dark .bg-gray-50 {
            background-color: #374151;
        }
        
        html.dark .text-gray-700 {
            color: #d1d5db;
        }
        
        html.dark .text-gray-800 {
            color: #f3f4f6;
        }
        
        html.dark .text-gray-500 {
            color: #9ca3af;
        }
        
        html.dark .border-gray-300 {
            border-color: #4b5563;
        }
        
        html.dark .bg-blue-50 {
            background-color: #1e3a8a;
        }
        
        html.dark .text-red-800 {
            color: #fca5a5;
        }
        
        html.dark .bg-red-200 {
            background-color: #7f1d1d;
        }
        
        html.dark .text-green-800 {
            color: #86efac;
        }
        
        html.dark .bg-green-200 {
            background-color: #15803d;
        }
        
        html.dark .text-blue-800 {
            color: #93c5fd;
        }
        
        html.dark .bg-blue-200 {
            background-color: #1e40af;
        }
        
        .theme-toggle {
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        .theme-toggle:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body class="bg-gray-100">
    <nav class="bg-gray-700 p-4">
        <div class="container mx-auto flex justify-between items-center">
            <a href="/" class="text-white text-xl font-bold transition-transform duration-300 hover:scale-110">Etkaroz</a>
            <div class="hidden md:flex space-x-4 items-center">
                <a href="/" class="text-white hover:text-blue-200 transition-colors duration-300 flex items-center gap-1">
                    <span>‚åÇ</span>
                    –ì–æ–ª–æ–≤–Ω–∞
                </a>
                <a href="/market" class="text-white hover:text-blue-200 transition-colors duration-300 flex items-center gap-1">
                    <span>‚õÅ</span>
                    –ú–∞–≥–∞–∑–∏–Ω
                </a>
                <a href="/cart" class="text-white hover:text-blue-200 transition-colors duration-300 flex items-center gap-1">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                    –ö–æ—à–∏–∫
                </a>
                <a href="/reviews" class="text-white hover:text-blue-200 transition-colors duration-300 flex items-center gap-1">
                    <span>üí≠</span>
                    –í—ñ–¥–≥—É–∫–∏
                </a>
                <a href="/about" class="text-white hover:text-blue-200 transition-colors duration-300 flex items-center gap-1">
                    <span>‚ìò</span>
                    –ü—Ä–æ –Ω–∞—Å
                </a>
                <a href="/api-demo" class="text-white hover:text-blue-200 transition-colors duration-300 flex items-center gap-1">
                    <span>‚ö°</span>
                    API Demo
                </a>
                <button id="theme-toggle" class="theme-toggle text-2xl" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É">‚òÄÔ∏è</button>
            </div>
            <button id="mobile-menu-button" class="md:hidden text-white w-6 h-6 relative focus:outline-none">
                <span class="burger-line block absolute h-0.5 w-6 bg-current transform transition duration-500 ease-in-out line1"></span>
                <span class="burger-line block absolute h-0.5 w-6 bg-current transform transition duration-500 ease-in-out line2"></span>
                <span class="burger-line block absolute h-0.5 w-6 bg-current transform transition duration-500 ease-in-out line3"></span>
            </button>
        </div>
        <div id="mobile-menu" class="hidden md:hidden overflow-hidden">
            <a href="/" class="block text-white hover:text-blue-200 py-2 transform transition duration-300 hover:translate-x-2">‚åÇ –ì–æ–ª–æ–≤–Ω–∞</a>
            <a href="/market" class="block text-white hover:text-blue-200 py-2 transform transition duration-300 hover:translate-x-2">‚õÅ –ú–∞–≥–∞–∑–∏–Ω</a>
            <a href="/cart" class="block text-white hover:text-blue-200 py-2 transform transition duration-300 hover:translate-x-2">üõí –ö–æ—à–∏–∫</a>
            <a href="/reviews" class="block text-white hover:text-blue-200 py-2 transform transition duration-300 hover:translate-x-2">üí≠ –í—ñ–¥–≥—É–∫–∏</a>
            <a href="/about" class="block text-white hover:text-blue-200 py-2 transform transition duration-300 hover:translate-x-2">‚ìò –ü—Ä–æ –Ω–∞—Å</a>
            <a href="/api-demo" class="block text-white hover:text-blue-200 py-2 transform transition duration-300 hover:translate-x-2">‚ö° API Demo</a>
            <button id="theme-toggle-mobile" class="theme-toggle block w-full text-left text-white hover:text-blue-200 py-2 transform transition duration-300 hover:translate-x-2" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É">‚òÄÔ∏è –¢–µ–º–Ω–∞ —Ç–µ–º–∞</button>
        </div>
    </nav>

    <div class="container mx-auto mt-8 p-4">
        {# Flash messages #}
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="space-y-2 mb-4">
                    {% for category, msg in messages %}
                        {% if category == 'error' %}
                            <div class="p-3 rounded bg-red-200 text-red-800" role="alert">{{ msg }}</div>
                        {% elif category == 'success' %}
                            <div class="p-3 rounded bg-green-200 text-green-800" role="alert">{{ msg }}</div>
                        {% else %}
                            <div class="p-3 rounded bg-blue-200 text-blue-800" role="alert">{{ msg }}</div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </div>

    <script>
        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuButton.addEventListener('click', () => {
            mobileMenuButton.classList.toggle('open');
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
                mobileMenu.classList.add('animate-slide-down');
                mobileMenu.classList.remove('animate-slide-up');
            } else {
                mobileMenu.classList.add('animate-slide-up');
                mobileMenu.classList.remove('animate-slide-down');
                setTimeout(() => {
                    mobileMenu.classList.add('hidden');
                }, 300);
            }
        });
        
        // Dark mode toggle
        const themeToggle = document.getElementById('theme-toggle');
        const themeToggleMobile = document.getElementById('theme-toggle-mobile');
        const html = document.documentElement;
        
        // Load saved theme preference or default to light mode
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            html.classList.add('dark');
            updateThemeButton();
        }
        
        function updateThemeButton() {
            const isDark = html.classList.contains('dark');
            const icon = isDark ? 'üåô' : '‚òÄÔ∏è';
            const label = isDark ? 'üåô –°–≤—ñ—Ç–ª–∞ —Ç–µ–º–∞' : '‚òÄÔ∏è –¢–µ–º–Ω–∞ —Ç–µ–º–∞';
            if (themeToggle) themeToggle.textContent = icon;
            if (themeToggleMobile) themeToggleMobile.textContent = label;
        }
        
        function toggleTheme() {
            html.classList.toggle('dark');
            const isDark = html.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateThemeButton();
        }
        
        if (themeToggle) {
            themeToggle.addEventListener('click', toggleTheme);
        }
        if (themeToggleMobile) {
            themeToggleMobile.addEventListener('click', toggleTheme);
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Don't trigger if user is typing in an input field
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                return;
            }
            
            // Check for Alt key combinations for better UX
            if (e.altKey) {
                switch(e.key.toLowerCase()) {
                    case 'h':
                    case '1':
                        e.preventDefault();
                        window.location.href = '/';
                        break;
                    case 'm':
                    case '2':
                        e.preventDefault();
                        window.location.href = '/market';
                        break;
                    case 'c':
                    case '3':
                        e.preventDefault();
                        window.location.href = '/cart';
                        break;
                    case 'r':
                    case '4':
                        e.preventDefault();
                        window.location.href = '/reviews';
                        break;
                    case 'a':
                    case '5':
                        e.preventDefault();
                        window.location.href = '/about';
                        break;
                    case 'd':
                    case '6':
                        e.preventDefault();
                        window.location.href = '/api-demo';
                        break;
                    case 't':
                        e.preventDefault();
                        toggleTheme();
                        break;
                }
            }
        });
        
        // Show keyboard shortcuts hint on page load
        const showKeyboardHint = () => {
            const hint = document.createElement('div');
            hint.id = 'keyboard-hint';
            hint.innerHTML = `
                <div style="position: fixed; bottom: 20px; right: 20px; background: rgba(0,0,0,0.8); color: white; padding: 15px 20px; border-radius: 10px; font-size: 12px; z-index: 1000; max-width: 300px;">
                    <div style="font-weight: bold; margin-bottom: 8px;">‚å®Ô∏è –ì–∞—Ä—è—á—ñ –∫–ª–∞–≤—ñ—à—ñ (Alt+):</div>
                    <div style="display: grid; grid-template-columns: auto 1fr; gap: 5px 10px;">
                        <span>Alt+H –∞–±–æ Alt+1</span><span>–ì–æ–ª–æ–≤–Ω–∞</span>
                        <span>Alt+M –∞–±–æ Alt+2</span><span>–ú–∞–≥–∞–∑–∏–Ω</span>
                        <span>Alt+C –∞–±–æ Alt+3</span><span>–ö–æ—à–∏–∫</span>
                        <span>Alt+R –∞–±–æ Alt+4</span><span>–í—ñ–¥–≥—É–∫–∏</span>
                        <span>Alt+A –∞–±–æ Alt+5</span><span>–ü—Ä–æ –Ω–∞—Å</span>
                        <span>Alt+D –∞–±–æ Alt+6</span><span>API Demo</span>
                        <span>Alt+T</span><span>–¢–µ–º–Ω–∞ —Ç–µ–º–∞</span>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 18px;">√ó</button>
                </div>
            `;
            document.body.appendChild(hint);
            
            // Auto-hide after 8 seconds
            setTimeout(() => {
                const hintEl = document.getElementById('keyboard-hint');
                if (hintEl) {
                    hintEl.style.transition = 'opacity 0.5s';
                    hintEl.style.opacity = '0';
                    setTimeout(() => hintEl.remove(), 500);
                }
            }, 8000);
        };
        
        // Show hint only once per session
        if (!sessionStorage.getItem('keyboard-hint-shown')) {
            setTimeout(showKeyboardHint, 1000);
            sessionStorage.setItem('keyboard-hint-shown', 'true');
        }
    </script>
</body>
</html>